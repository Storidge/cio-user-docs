<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cluster Setup</title>
    <meta name="description" content="User documentation for Storidge CIO software">
    
    
    <link rel="preload" href="/assets/css/0.styles.34c260e6.css" as="style"><link rel="preload" href="/assets/js/app.e05b9c7f.js" as="script"><link rel="preload" href="/assets/js/28.1456a03c.js" as="script"><link rel="prefetch" href="/assets/js/10.82c0bb7a.js"><link rel="prefetch" href="/assets/js/11.f60b7486.js"><link rel="prefetch" href="/assets/js/12.92564031.js"><link rel="prefetch" href="/assets/js/13.94cac131.js"><link rel="prefetch" href="/assets/js/14.126fd42e.js"><link rel="prefetch" href="/assets/js/15.cd9215ed.js"><link rel="prefetch" href="/assets/js/16.f3160673.js"><link rel="prefetch" href="/assets/js/17.bac0da4d.js"><link rel="prefetch" href="/assets/js/18.cfe5f0e7.js"><link rel="prefetch" href="/assets/js/19.a580bafd.js"><link rel="prefetch" href="/assets/js/2.a74784fd.js"><link rel="prefetch" href="/assets/js/20.bdfdc673.js"><link rel="prefetch" href="/assets/js/21.2de97583.js"><link rel="prefetch" href="/assets/js/22.7069a8b6.js"><link rel="prefetch" href="/assets/js/23.7aea708e.js"><link rel="prefetch" href="/assets/js/24.5ec3c2d0.js"><link rel="prefetch" href="/assets/js/25.2e88b90c.js"><link rel="prefetch" href="/assets/js/26.8b871e95.js"><link rel="prefetch" href="/assets/js/27.7bda0b9c.js"><link rel="prefetch" href="/assets/js/29.e78a0e6b.js"><link rel="prefetch" href="/assets/js/3.652aaa99.js"><link rel="prefetch" href="/assets/js/30.6ac6d22e.js"><link rel="prefetch" href="/assets/js/31.f465c10a.js"><link rel="prefetch" href="/assets/js/32.c650f2c9.js"><link rel="prefetch" href="/assets/js/33.a8705f17.js"><link rel="prefetch" href="/assets/js/34.7a5e2be1.js"><link rel="prefetch" href="/assets/js/35.e4979297.js"><link rel="prefetch" href="/assets/js/36.a088f027.js"><link rel="prefetch" href="/assets/js/37.39d44fed.js"><link rel="prefetch" href="/assets/js/38.c1753ec3.js"><link rel="prefetch" href="/assets/js/39.ca2d0ec3.js"><link rel="prefetch" href="/assets/js/4.a5dbc094.js"><link rel="prefetch" href="/assets/js/40.e9a5ef27.js"><link rel="prefetch" href="/assets/js/41.be51cf9f.js"><link rel="prefetch" href="/assets/js/42.042b7ec2.js"><link rel="prefetch" href="/assets/js/43.61eb9721.js"><link rel="prefetch" href="/assets/js/44.846f8bec.js"><link rel="prefetch" href="/assets/js/45.0cbe395a.js"><link rel="prefetch" href="/assets/js/46.7ab0865a.js"><link rel="prefetch" href="/assets/js/47.9840030e.js"><link rel="prefetch" href="/assets/js/48.da121484.js"><link rel="prefetch" href="/assets/js/49.0dee9f7b.js"><link rel="prefetch" href="/assets/js/5.e2683d3f.js"><link rel="prefetch" href="/assets/js/50.d02e44d8.js"><link rel="prefetch" href="/assets/js/51.9dad44d4.js"><link rel="prefetch" href="/assets/js/52.e69701c3.js"><link rel="prefetch" href="/assets/js/6.c2ad22f6.js"><link rel="prefetch" href="/assets/js/7.e3242b4d.js"><link rel="prefetch" href="/assets/js/8.cc24321b.js"><link rel="prefetch" href="/assets/js/9.276401ad.js">
    <link rel="stylesheet" href="/assets/css/0.styles.34c260e6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://storidge.com/wp-content/uploads/2017/06/logowc2d.png" alt="" class="logo"> <!----></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://storidge.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://storidge.com/api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/storidge" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://storidge.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://storidge.com/api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/storidge" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Get Started</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Docker Volumes</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Kubernetes Storage</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Profiles</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Cluster</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/cluster/overview.html" class="sidebar-link">Overview</a></li><li><a href="/cluster/cluster_setup.html" class="active sidebar-link">Cluster Setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cluster/cluster_setup.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/cluster/cluster_setup.html#four-networked-hosts" class="sidebar-link">Four networked hosts</a></li><li class="sidebar-sub-header"><a href="/cluster/cluster_setup.html#storage-resources-on-hosts" class="sidebar-link">Storage resources on hosts</a></li><li class="sidebar-sub-header"><a href="/cluster/cluster_setup.html#ip-address-of-the-sds-node" class="sidebar-link">IP address of the sds node</a></li><li class="sidebar-sub-header"><a href="/cluster/cluster_setup.html#open-ports-between-hosts" class="sidebar-link">Open ports between hosts</a></li><li class="sidebar-sub-header"><a href="/cluster/cluster_setup.html#install-cio" class="sidebar-link">Install CIO</a></li></ul></li><li><a href="/cluster/create_a_cluster.html" class="sidebar-link">Create a Cluster</a></li><li><a href="/cluster/add_a_node.html" class="sidebar-link">Add a node</a></li><li><a href="/cluster/remove_a_node.html" class="sidebar-link">Remove a node</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cookbook</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cloud Reference Guide</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>cio commands</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>cioctl commands</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Release Notes</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="cluster-setup"><a href="#cluster-setup" aria-hidden="true" class="header-anchor">#</a> Cluster Setup</h1> <h2 id="prerequisites"><a href="#prerequisites" aria-hidden="true" class="header-anchor">#</a> <strong>Prerequisites</strong></h2> <p>To run through this guide, you need the following:</p> <ul><li><a href="#four-networked-hosts">Four networked Linux hosts</a></li> <li><a href="#storage-resources-on-hosts">One boot drive and three data drives per host</a></li> <li><a href="#ip-address-of-the-sds-node">IP address of the sds node </a></li> <li><a href="#open-ports-between-hosts">Open ports between hosts</a></li> <li><a href="#install-cio">CIO software installed</a></li></ul> <h2 id="four-networked-hosts"><a href="#four-networked-hosts" aria-hidden="true" class="header-anchor">#</a> <strong>Four networked hosts</strong></h2> <p>This guide requires four Linux hosts which can communicate over a network. They can be physical machines, virtual servers, or cloud instances. While three nodes minimum is required to form a cluster, four nodes minimum are recommended for operating redundancy.</p> <p>You can use <code>docker-machine create</code> to provision virtual servers. Here are examples using <a href="https://rominirani.com/docker-swarm-tutorial-b67470cf8872" target="_blank" rel="noopener noreferrer">VirtualBox<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-cluster-of-docker-containers-with-docker-swarm-and-digitalocean-on-centos-7" target="_blank" rel="noopener noreferrer">DigitalOcean<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>The first node used takes the sds controller role. Roles for backup nodes and storage node are assigned automatically during cluster creation.</p> <p><strong>Note:</strong>  You can follow many of the steps to test single-node clusters. In this case, you need only one host. While multi-node commands do not work, you can initialize a cluster, create persistent volumes and run stateful containers and services.</p> <h2 id="storage-resources-on-hosts"><a href="#storage-resources-on-hosts" aria-hidden="true" class="header-anchor">#</a> <strong>Storage resources on hosts</strong></h2> <p>Each host will require one boot drive and a minimum of three <a href="http://storidge.com/docs/data-drive-requirements/" target="_blank" rel="noopener noreferrer">data drives<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The CIO software aggregates the data drives into a storage pool to deliver data protection and availability across drive and node failures.</p> <h2 id="ip-address-of-the-sds-node"><a href="#ip-address-of-the-sds-node" aria-hidden="true" class="header-anchor">#</a> <strong>IP address of the sds node</strong></h2> <p>The IP address must on a network interface available to the host operating system. Since all nodes in the cluster need to connect to the sds node at this IP address,  you should use a fixed IP address. Use <code>ifconfig</code> on Linux to see a list of available network interfaces.</p> <p><strong>Note:</strong> The <code>cioctl create</code> command will suggest the first IP address found if the host is multi-homed, i.e. have more than one network connection. You can change to the desired IP address using the <code>--ip</code> flag.</p> <h2 id="open-ports-between-hosts"><a href="#open-ports-between-hosts" aria-hidden="true" class="header-anchor">#</a> <strong>Open ports between hosts</strong></h2> <p>The following ports must be available for CIO to run.</p> <ul><li>**TCP ports 2505, 9997, 9998, 9999 ** for cluster communications</li> <li><strong>TCP</strong> port <strong>3260</strong> for backend storage traffic</li></ul> <p>The following ports are needed for Docker Swarm.</p> <ul><li><strong>TCP port 2377</strong> for cluster management communications</li> <li><strong>TCP</strong> and <strong>UDP port 7946</strong> for communication among nodes</li> <li><strong>UDP port 4789</strong> for overlay network traffic</li></ul> <h2 id="install-cio"><a href="#install-cio" aria-hidden="true" class="header-anchor">#</a> <strong>Install CIO</strong></h2> <p>A convenience script is provided for installing the free version of CIO into development environments quickly and non-interactively. This is recommended for dev environments only, as root permissions are required to run them. This script will detect your Linux distribution and version, and install all dependencies and suggestions of the package manager without asking for confirmation.</p> <p>CIO currently supports CentOS 7.4 (3.10 kernel), RHEL 7 (3.10 kernel) and Ubuntu 14.04LTS (3.13 kernel). After verifying you have a supported distribution, run the demo script below to begin installation.</p> <div class="language- extra-class"><pre class="language-text"><code>curl -fsSL ftp://download.storidge.com/pub/free/demo | sudo bash
</code></pre></div><p>Example:</p> <div class="language- extra-class"><pre class="language-text"><code>root@c1:~# curl -fsSL ftp://download.storidge.com/pub/free/demo | sudo bash
Started installing release 2148 at Tue Jan 30 12:47:26 PST 2018
Loading cio software for: u16  (4.4.0-104-generic)
...
...
...
latest: Pulling from portainer/portainer
Digest: sha256:232742dcb04faeb109f1086241f290cb89ad4c0576e75197e902ca6e3bf3a9fc
Status: Image is up to date for portainer/portainer:latest
Finished at Tue Jan 30 12:48:04 PST 2018
cio software installation complete. cio requires a minimum of 3 local drives per node for data redundancy

Please verify local drives are available, then run 'cioctl create' command on primary node to start a new cluster

</code></pre></div><h4 id="add-nodes"><a href="#add-nodes" aria-hidden="true" class="header-anchor">#</a> <strong>Add nodes</strong></h4> <p>Repeat the same CIO installation on all nodes that will be members of the cluster.</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/5/2019, 2:47:29 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/cluster/overview.html" class="prev">
          Overview
        </a></span> <span class="next"><a href="/cluster/create_a_cluster.html">
          Create a Cluster
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.e05b9c7f.js" defer></script><script src="/assets/js/28.1456a03c.js" defer></script>
  </body>
</html>
